#cloud-config
hostname: rpi-box-01
manage_etc_hosts: true

users:
  - name: CHANGE_ME
    gecos: "CHANGE_ME"
    groups: [users, adm, dialout, audio, netdev, video, plugdev, cdrom, games, input, gpio, spi, i2c, render, sudo]
    shell: /bin/bash
    sudo: "ALL=(ALL) NOPASSWD:ALL"
    lock_passwd: true
    ssh_authorized_keys:
      - ssh-ed25519 CHANGE_ME user@example

ssh_pwauth: false
disable_root: true

timezone: Europe/Dublin

write_files:
  - path: /etc/ssh/sshd_config.d/99-disable-passwords.conf
    owner: root:root
    permissions: '0644'
    content: |
      PasswordAuthentication no
      ChallengeResponseAuthentication no
      UsePAM yes

runcmd:
  - [ systemctl, restart, ssh ]
