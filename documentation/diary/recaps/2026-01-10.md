# Recap for 2026-01-10

- Fixed `pi_base` task YAML: `fail_msg` must be nested under `ansible.builtin.assert` to avoid conflicting action statements.
- Fixed `docker_engine` Docker apt repository configuration by auto-detecting Debian vs Ubuntu and using the matching `download.docker.com` URLs; added a fail-fast assert that `docker_engine_apt_release` matches `ansible_distribution_release`.
- Updated documentation to clarify `docker_engine_apt_release` expectations and the optional `docker_engine_apt_repo_os` override.
- Updated `documentation/fast start.md` to be a better quick reference and added it to `documentation/README.md` (documentation index).
- Updated `scripts/ansible-smoke.sh` to accept an optional `--limit`-style third argument (host/group) and documented it.
- Fixed `ansible-lint` yaml line-length failures by wrapping long lines in `docker_engine` and `pi_base` task files.
- Expanded ADR-0006 with a monthly review cadence and an upgrade procedure for pinned toolchain versions; linked it from the documentation index.
- Switched the `NODE_EXPORTER_LISTEN_ADDRESS` example in `.env.example` to `127.0.0.1:9100` and documented the recommended secure default until Prometheus exists.
- Updated local `.env` to bind node exporter to `127.0.0.1:9100` so all boxes using env lookups stop exposing `:9100` on the LAN by default.
- Added a “dry-run and review changes” example to `documentation/fast start.md` for applying `pi-base.yml` to boxes already running services.
- Added ADR-0011 (Proposed) to capture the intended Prometheus/node-exporter/Grafana monitoring architecture and security defaults.
- Adjusted `docker_engine` to force `apt-get update` after adding the Docker repo (avoids stale-cache issues when `pi_base` already refreshed apt earlier in the run).
- Improved `docker_engine` check mode behavior: read-only repo checks run in `--check`, package installation is skipped, and missing candidates/versions emit debug notes instead of aborting.
- Fixed `ansible-lint` `key-order[task]` for the `docker_engine` install block task.
- Added `tmux_config` role to install tmux and manage `/etc/tmux.conf`; wired into `pi-base.yml` and added a `--tags tmux` example to fast start.
- Added `documentation/tmux_quick_reference.md` to the documentation index and removed emoji characters to match repo markdown guidelines.
- Made `docker_engine`'s post-repo apt cache refresh report `changed=false` so the smoke test can validate idempotency without failing on cache updates.
- Fixed `ansible-lint` `yaml[empty-lines]` in `tmux_config` tasks.
- Added `scripts/ansible-lint.sh` to run `ansible-lint` without executing the playbook; documented it in fast start.
- Documented `scripts/ansible-lint.sh` in `documentation/how to test.md` and linked it from the documentation index.
- Updated `scripts/ansible-smoke.sh` and `scripts/ansible-lint.sh` to suppress noisy Python DeprecationWarnings during `ansible-lint`; fixed the smoke-test command typo in fast start.
- Updated the lint scripts to prefer `python3 -W ignore::DeprecationWarning -m ansiblelint` for more reliable warning suppression.
- Filtered the remaining noisy `pathspec` `GitWildMatchPattern` DeprecationWarnings from `ansible-lint` stderr in `scripts/ansible-lint.sh` and `scripts/ansible-smoke.sh`.
- Added a tmux workspace launcher: `Makefile` target `workspace` and `workspace.sh` to create/attach a session with standard windows.
- Documented the launcher in `documentation/tmux_workspace.md` and linked it from `documentation/README.md` and `documentation/fast start.md`.
- Clarified that the workspace is a host-machine workflow and added a fail-fast guard if `workspace.sh` is run inside a container (override via `WORKSPACE_ALLOW_IN_CONTAINER=1`).
- Documented `WORKSPACE_ALLOW_IN_CONTAINER` in `.env.example` and added optional validation in `.devcontainer/scripts/validate-env.sh`.
- Updated `docker_smoke_test` to set `build: never` to avoid Compose warnings when the smoke test uses only pre-built images.
