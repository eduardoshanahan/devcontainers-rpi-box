# User Configuration
# ==================
# These variables are REQUIRED and must be set correctly
# for the container and scripts to work properly.

# Project name used to derive container names/hostnames
# Format: lowercase letters, numbers, or hyphens
PROJECT_NAME=devcontainers-rpi-box

# tmux Workspace (host machine)
# ============================
# These are used by `make workspace` / `workspace.sh` on the host machine.

# Set to 1/true to allow running `workspace.sh` inside a container (not recommended).
WORKSPACE_ALLOW_IN_CONTAINER=0

# System username (must match your host system username)
# Format: lowercase letters, numbers, underscore, or hyphen
# Command to get value: echo $USER
HOST_USERNAME=exampleuser

# User ID (must match your host system UID)
# Format: positive integer
# Command to get value: id -u
HOST_UID=1000

# Group ID (must match your host system GID)
# Format: positive integer
# Command to get value: id -g
HOST_GID=1000

# Editor choice
# Allowed values: 'code' or 'cursor' or 'antigravity'
EDITOR_CHOICE=code

# Locale (must exist in /etc/locale.gen)
# Example: en_IE.UTF-8
LOCALE=en_IE.UTF-8

# Container Configuration
# =====================
# These variables are REQUIRED

# Container hostname (shown in prompt)
# Format: letters, numbers, and hyphens
CONTAINER_HOSTNAME=${PROJECT_NAME}-${EDITOR_CHOICE}

# Workspace path inside the container
WORKSPACE_FOLDER=/workspace

# Container resource limits
# These control the resources allocated to the dev container

# Container memory limit
# Format: positive value with unit (e.g., 4g, 8g, 16g)
CONTAINER_MEMORY=6g

# Container CPU limit
# Format: positive number (can be decimal like 2.5)
CONTAINER_CPUS=4

# Container shared memory size
# Format: positive value with unit (e.g., 2g, 4g, 8g)
CONTAINER_SHM_SIZE=4g

# Git Configuration
# ================
# Git user settings for commits (required for devcontainer launchers)

# Git remote repository URL (optional unless your workflow needs it)
# Format: valid git repository URL (https:// or git@)
# Example: https://github.com/username/repo.git
# Example: git@github.com:username/repo.git
GIT_REMOTE_URL="git@github.com:example/${PROJECT_NAME}.git"

# Git user name (required)
# Format: letters, numbers, spaces, dots, underscores, or hyphens
GIT_USER_NAME="Example User"

# Git email (required)
# Format: valid email address
GIT_USER_EMAIL="example.user@example.com"

# Git sync configuration
# ======================

# Remotes to pull from (space or comma separated). The first entry acts as the primary remote for pulls/resets.
# Example: origin lan
GIT_SYNC_REMOTES="origin"

# List of remotes to push after syncing (space/comma separated). Leave empty to skip pushes.
# Example: origin lan
GIT_SYNC_PUSH_REMOTES=""

# Remote-specific URLs used when the script needs to add a missing remote.
# Provide entries matching your remote names (uppercased, non-alphanumeric replaced with underscores).
# Example:
# GIT_REMOTE_URL_LAN=ssh://git@192.168.1.10:/volume1/git/${PROJECT_NAME}.git

# Docker Configuration
# ==================
# Docker image naming (required)

# Docker image name
# Format: lowercase letters, numbers, hyphens, underscores, or dots
DOCKER_IMAGE_NAME=${PROJECT_NAME}-${EDITOR_CHOICE}

# Docker image tag
# Format: letters, numbers, hyphens, underscores, or dots
DOCKER_IMAGE_TAG=latest

# Devcontainer Cleanup
# ==================
# Retention window for unused devcontainer images (days)
DEVCONTAINER_IMAGE_RETENTION_DAYS=7

# Ansible Configuration
# =====================
# These keep tooling paths obvious and editable without digging into devcontainer.json

# Path to the Ansible config file inside the container/workspace
ANSIBLE_CONFIG=${WORKSPACE_FOLDER}/src/ansible.cfg

# Path to the default inventory file
ANSIBLE_INVENTORY=${WORKSPACE_FOLDER}/src/inventory/hosts.ini

# Ansible smoke test inputs (required if running scripts/ansible-smoke.sh without CLI args)
SMOKE_PLAYBOOK=${WORKSPACE_FOLDER}/src/playbooks/sample.yml
SMOKE_INVENTORY=${WORKSPACE_FOLDER}/src/inventory/hosts.ini

# Additional collection search paths (project-local first, then user cache)
ANSIBLE_COLLECTIONS_PATH=${WORKSPACE_FOLDER}/src/collections:/home/${HOST_USERNAME}/.ansible/collections

# Role search path (project-local)
ANSIBLE_ROLES_PATH=${WORKSPACE_FOLDER}/src/roles

# Host variables (consumed by Ansible host_vars via env lookups)
# Ansible SSH user and key path used for host connections
ANSIBLE_USER=exampleuser
ANSIBLE_SSH_PRIVATE_KEY_FILE=~/.ssh/example_key
# PI base admin user and public key path (used to provision SSH access)
PI_BASE_ADMIN_USER=exampleuser
PI_BASE_ADMIN_SSH_PUBLIC_KEY_FILE=~/.ssh/example_key.pub
# Disable systemd-resolved stub listener for DNS apps (Pi-hole)
PI_BASE_DISABLE_RESOLVED_STUB=false
PI_BASE_RESOLV_CONF_TARGET=/run/systemd/resolve/resolv.conf
# Daily report email settings (msmtp)
DAILY_REPORT_EMAIL="example.user@example.com"
DAILY_REPORT_SENDER="example.user@example.com"
DAILY_REPORT_SMTP_HOST="smtp.example.com"
DAILY_REPORT_SMTP_PORT=587
DAILY_REPORT_SMTP_USER="example.user@example.com"
DAILY_REPORT_SMTP_PASSWORD="CHANGE_ME"
DAILY_REPORT_USER=exampleuser
DAILY_REPORT_SCRIPT_PATH="/usr/local/bin/daily-report.sh"
DAILY_REPORT_SERVICE_NAME="daily-report"
DAILY_REPORT_MSMTP_LOG_PATH="/var/log/msmtp/msmtp.log"

# Role Configuration (required)
# =============================
# These values must be supplied via host_vars/group_vars (env lookups are optional).
FAIL2BAN_BASE_BANTIME=1h
FAIL2BAN_BASE_FINDTIME=10m
FAIL2BAN_BASE_MAXRETRY=5
FAIL2BAN_BASE_IGNOREIP="127.0.0.1/8 ::1"
FAIL2BAN_BASE_BACKEND=systemd

TIME_SYNC_NTP_SERVERS="pool.ntp.org"
TIME_SYNC_FALLBACK_SERVERS="time.cloudflare.com"

LOG_HYGIENE_JOURNALD_MAX_USE=200M
LOG_HYGIENE_JOURNALD_KEEP_FREE=100M
LOG_HYGIENE_JOURNALD_MAX_FILE_SEC=1month
LOG_HYGIENE_LOGROTATE_ROTATE=7
LOG_HYGIENE_LOGROTATE_FREQUENCY=weekly

# Bind node exporter to localhost by default (safer until Prometheus is set up).
# When you add a Prometheus server, either firewall this port to Prometheus only
# or change the bind address as appropriate for your network.
NODE_EXPORTER_LISTEN_ADDRESS="127.0.0.1:9100"

STORAGE_LAYOUT_DIRECTORIES='[{"path":"/srv/apps","owner":"root","group":"root","mode":"0755"},{"path":"/srv/docker","owner":"root","group":"root","mode":"0755"}]'

DOCKER_ENGINE_DATA_ROOT=/srv/docker
DOCKER_ENGINE_LOG_MAX_SIZE=10m
DOCKER_ENGINE_LOG_MAX_FILE=3
DOCKER_ENGINE_USERS="exampleuser"
DOCKER_ENGINE_APT_RELEASE=jammy
DOCKER_ENGINE_VERSION=""
DOCKER_ENGINE_COMPOSE_VERSION=""

DOCKER_PRUNE_SCHEDULE=weekly
DOCKER_PRUNE_COMMAND="/usr/bin/docker system prune --all --force"
DOCKER_PRUNE_SERVICE_NAME=docker-prune

COMMON_TOOLS_PACKAGES="curl git nano tmux htop rsync unzip jq dnsutils iotop iftop nload net-tools vnstat needrestart ncdu tcpdump lsof strace"

# Tooling Versions
# ===========================

PYTHON_VERSION=3.11
ANSIBLE_CORE_VERSION=2.17.*
ANSIBLE_LINT_VERSION=25.12.1
YAMLLINT_VERSION=1.35.*

# Sync Script Controls (required when running scripts/sync-git.sh)
# ================================================================

BRANCH=main
FORCE_PULL=false

# Backup Configuration (Restic)
# =============================
# Path to the Restic repository (destination)
BACKUP_RESTIC_REPO=/mnt/backup/restic-repo

# Directory to back up (source)
BACKUP_RESTIC_SRC=/srv/docker

# Restic password
BACKUP_RESTIC_PASSWORD="CHANGE_ME"

# Restic retention policy (required by backup_restic role)
BACKUP_RESTIC_RETENTION_DAYS=7
BACKUP_RESTIC_RETENTION_WEEKS=4
BACKUP_RESTIC_RETENTION_MONTHS=6

# Restic timer schedule (systemd OnCalendar format)
BACKUP_RESTIC_TIMER_SCHEDULE="daily"

# Optional API keys
# =================
# OpenAI Codex API Key (only required if you use Codex in this workspace)
OPENAI_API_KEY="CHANGE_ME"
